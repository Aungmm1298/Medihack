<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ผู้บริหาร / Executive Dashboard - Patient Flow Analytics System</title>
    <link rel="icon" type="image/png" href="images/mfu-logo.png">
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="navbar-container">
            <div class="navbar-header">
                <div class="navbar-brand">
                    <div class="navbar-logo">
                        <img src="images/mfu-logo.png" alt="MFU Logo" onerror="this.style.display='none'">
                    </div>
                    <div class="logo-divider"></div>
                    <div class="navbar-title">
                        <h1>โรงพยาบาลศูนย์การแพทย์มหาวิทย าลัยแม่ฟ้าหลวง</h1>
                        <p>MAE FAH LUANG UNIVERSITY MEDICAL CENTER HOSPITAL - Executive Analytics</p>
                    </div>
                </div>
                <div class="navbar-logo-right">
                    <div class="mfu-logo-text">MFU<br>MCH</div>
                </div>
            </div>
            <div class="navbar-menu-wrapper">
                <ul class="navbar-menu">
                    <li><a href="admin-dashboard.html">Dashboard</a></li>
                    <li><a href="#" id="userName" style="background-color: rgba(0, 0, 0, 0.1); font-weight: 600;">Executive</a></li>
                    <li><a href="#" onclick="logout()" style="background-color: var(--alert-red); font-weight: 600;">Logout</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Dashboard Layout -->
    <div class="dashboard">
        <!-- Sidebar -->
        <aside class="sidebar">
            <ul class="sidebar-menu">
                <li><a href="#overview" class="active" id="overviewLink" onclick="showExecutiveDashboard(); return false;">ภาพรวม / Overview</a></li>
                <li><a href="#" id="analyticsLink" onclick="showAnalytics(); return false;">AI Analytics</a></li>
                <li><a href="#" id="createUserLink" onclick="showCreateUser(); return false;">สร้างผู้ใช้ / Create User</a></li>
            </ul>
        </aside>

        <!-- Main Content -->
        <main class="main-content" id="mainContent">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                <h2 style="color: var(--mfu-green); margin: 0;">แดชบอร์ดผู้บริหาร / Executive Dashboard</h2>
                <div style="display: flex; gap: 1rem;">
                    <select class="btn btn-secondary" style="padding: 0.75rem 1.5rem; cursor: pointer;" onchange="changePeriod(this.value)">
                        <option value="today">วันนี้ / Today</option>
                        <option value="week">สัปดาห์นี้ / This Week</option>
                        <option value="month" selected>เดือนนี้ / This Month</option>
                        <option value="year">ปีนี้ / This Year</option>
                    </select>
                </div>
            </div>

            <!-- Key Performance Indicators -->
            <h3 style="color: var(--mfu-green); margin-bottom: 1rem;">ตัวชี้วัดหลัก / Key Performance Indicators</h3>
            <div class="stats-container">
                <div class="stat-card">
                    <div class="stat-value">3,847</div>
                    <div class="stat-label">ผู้ป่วยทั้งหมด<br>Total Patients</div>
                    <div class="stat-change positive">↑ +12.5% จากเดือนที่แล้ว</div>
                </div>
                <div class="stat-card" style="border-left-color: var(--gold-nav);">
                    <div class="stat-value" style="color: var(--gold-nav);">16.8</div>
                    <div class="stat-label">เวลารอเฉลี่ย (นาที)<br>Avg Wait Time (min)</div>
                    <div class="stat-change positive">↓ ลดลง 18% ดีขึ้น</div>
                </div>
                <div class="stat-card" style="border-left-color: #3B82F6;">
                    <div class="stat-value" style="color: #3B82F6;">94.2%</div>
                    <div class="stat-label">ความแม่นยำ AI<br>AI Accuracy</div>
                    <div class="stat-change positive">↑ +2.3% ดีขึ้น</div>
                </div>
                <div class="stat-card" style="border-left-color: #10B981;">
                    <div class="stat-value" style="color: #10B981;">4.6/5</div>
                    <div class="stat-label">ความพึงพอใจ<br>Satisfaction Score</div>
                    <div class="stat-change positive">↑ +0.3 ดีขึ้น</div>
                </div>
            </div>

            <!-- Doctor & Patient Features -->
            <h3 style="color: var(--mfu-green); margin-top: 2rem; margin-bottom: 1rem;">คุณสมบัติระบบ / System Features</h3>
            <div class="card-grid" style="margin-bottom: 2rem;">
                <div class="card" style="background: linear-gradient(135deg, #f0f9ff 0%, #ffffff 100%); border-left: 4px solid #3B82F6;">
                    <h3 style="color: #3B82F6; margin-bottom: 1.5rem;"> คุณสมบัติแพทย์ / Doctor Features</h3>
                    <ul style="list-style: none; padding: 0; margin: 0;">
                        <li style="padding: 0.75rem 0; border-bottom: 1px solid var(--border-gray); display: flex; align-items: center;">
                            <span style="color: #3B82F6; font-size: 1.25rem; margin-right: 0.75rem;">✓</span>
                            <span>การจัดการแพทย์ / Doctor Management</span>
                        </li>
                        <li style="padding: 0.75rem 0; border-bottom: 1px solid var(--border-gray); display: flex; align-items: center;">
                            <span style="color: #3B82F6; font-size: 1.25rem; margin-right: 0.75rem;">✓</span>
                            <span>ติดตามประสิทธิภาพ / Performance Tracking</span>
                        </li>
                        <li style="padding: 0.75rem 0; border-bottom: 1px solid var(--border-gray); display: flex; align-items: center;">
                            <span style="color: #3B82F6; font-size: 1.25rem; margin-right: 0.75rem;">✓</span>
                            <span>การจัดตารางเวลา / Scheduling</span>
                        </li>
                        <li style="padding: 0.75rem 0; border-bottom: 1px solid var(--border-gray); display: flex; align-items: center;">
                            <span style="color: #3B82F6; font-size: 1.25rem; margin-right: 0.75rem;">✓</span>
                            <span>รายงานการตรวจ / Examination Reports</span>
                        </li>
                        <li style="padding: 0.75rem 0; display: flex; align-items: center;">
                            <span style="color: #3B82F6; font-size: 1.25rem; margin-right: 0.75rem;">✓</span>
                            <span>สถิติผู้ป่วย / Patient Statistics</span>
                        </li>
                    </ul>
                    <div style="margin-top: 1.5rem; padding: 1rem; background: white; border-radius: 8px; text-align: center;">
                        <div style="font-size: 2rem; font-weight: 700; color: #3B82F6;">15</div>
                        <div style="font-size: 0.95rem; color: var(--text-secondary);">แพทย์ออนไลน์ / Active Doctors</div>
                    </div>
                    <button class="btn btn-primary" onclick="showDoctorRoomPerformance()" style="width: 100%; margin-top: 1rem; background: #3B82F6; border-color: #3B82F6;">
                        ติดตามห้องตรวจ / Check Doctor Rooms
                    </button>
                </div>

                <div class="card" style="background: linear-gradient(135deg, #fef3c7 0%, #ffffff 100%); border-left: 4px solid var(--gold-nav);">
                    <h3 style="color: var(--gold-nav); margin-bottom: 1.5rem;"> คุณสมบัติผู้ป่วย / Patient Features</h3>
                    <ul style="list-style: none; padding: 0; margin: 0;">
                        <li style="padding: 0.75rem 0; border-bottom: 1px solid var(--border-gray); display: flex; align-items: center;">
                            <span style="color: var(--gold-nav); font-size: 1.25rem; margin-right: 0.75rem;">✓</span>
                            <span>ติดตามผู้ป่วย / Patient Monitoring</span>
                        </li>
                        <li style="padding: 0.75rem 0; border-bottom: 1px solid var(--border-gray); display: flex; align-items: center;">
                            <span style="color: var(--gold-nav); font-size: 1.25rem; margin-right: 0.75rem;">✓</span>
                            <span>นัดหมาย / Appointments</span>
                        </li>
                        <li style="padding: 0.75rem 0; border-bottom: 1px solid var(--border-gray); display: flex; align-items: center;">
                            <span style="color: var(--gold-nav); font-size: 1.25rem; margin-right: 0.75rem;">✓</span>
                            <span>ประวัติการรักษา / Medical Records</span>
                        </li>
                        <li style="padding: 0.75rem 0; border-bottom: 1px solid var(--border-gray); display: flex; align-items: center;">
                            <span style="color: var(--gold-nav); font-size: 1.25rem; margin-right: 0.75rem;">✓</span>
                            <span>การทำนาย AI / AI Predictions</span>
                        </li>
                        <li style="padding: 0.75rem 0; display: flex; align-items: center;">
                            <span style="color: var(--gold-nav); font-size: 1.25rem; margin-right: 0.75rem;">✓</span>
                            <span>คิวและเวลารอ / Queue & Wait Time</span>
                        </li>
                    </ul>
                    <div style="margin-top: 1.5rem; padding: 1rem; background: white; border-radius: 8px; text-align: center;">
                        <div style="font-size: 2rem; font-weight: 700; color: var(--gold-nav);">3,847</div>
                        <div style="font-size: 0.95rem; color: var(--text-secondary);">ผู้ป่วยเดือนนี้ / Patients This Month</div>
                    </div>
                    <button class="btn btn-primary" onclick="showPatientOptions()" style="width: 100%; margin-top: 1rem; background: var(--gold-nav); border-color: var(--gold-nav);">
                        ตรวจสอบผู้ป่วย / Check Patient
                    </button>
                </div>
            </div>

            <!-- Real-time Status -->
            <div class="card" style="margin-top: 2rem; background: linear-gradient(135deg, #ffffff 0%, #f0fdf4 100%);">
                <div class="card-header">
                    <h3 class="card-title">สถานะเรียลไทม์ / Real-Time Status</h3>
                </div>
                <div class="stats-container" style="margin: 0;">
                    <div style="text-align: center;">
                        <div style="font-size: 3rem; font-weight: 700; color: var(--gold-nav);">24</div>
                        <div style="font-size: 1.125rem; color: var(--text-secondary);">ผู้ป่วยในคิว<br>In Queue</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 3rem; font-weight: 700; color: #3B82F6;">8</div>
                        <div style="font-size: 1.125rem; color: var(--text-secondary);">กำลังรักษา<br>In Treatment</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 3rem; font-weight: 700; color: var(--mfu-green);">142</div>
                        <div style="font-size: 1.125rem; color: var(--text-secondary);">เสร็จวันนี้<br>Completed Today</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 3rem; font-weight: 700; color: var(--mfu-green);">12/15</div>
                        <div style="font-size: 1.125rem; color: var(--text-secondary);">แพทย์ออนไลน์<br>Doctors Online</div>
                    </div>
                </div>
            </div>

            <!-- Department Performance -->
            <div class="card" style="margin-top: 2rem;">
                <div class="card-header">
                    <h3 class="card-title">ประสิทธิภาพแต่ละแผนก / Department Performance</h3>
                </div>
                <div class="data-table">
                    <table>
                        <thead>
                            <tr>
                                <th>แผนก / Department</th>
                                <th>ผู้ป่วย / Patients</th>
                                <th>เวลาเฉลี่ย / Avg Time</th>
                                <th>ประสิทธิภาพ / Efficiency</th>
                                <th>ความพึงพอใจ / Satisfaction</th>
                                <th>สถานะ / Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>OPD (อายุรกรรม)</strong><br><span style="font-size: 0.95rem; color: var(--text-secondary);">Internal Medicine</span></td>
                                <td><strong style="font-size: 1.25rem;">1,245</strong></td>
                                <td>15.3 นาที / min</td>
                                <td><strong style="color: var(--mfu-green);">96%</strong></td>
                                <td> 4.7/5.0</td>
                                <td><span class="status-badge status-completed">ดีเยี่ยม / Excellent</span></td>
                            </tr>
                            <tr>
                                <td><strong>ศัลยกรรม</strong><br><span style="font-size: 0.95rem; color: var(--text-secondary);">Surgery</span></td>
                                <td><strong style="font-size: 1.25rem;">487</strong></td>
                                <td>22.1 นาที / min</td>
                                <td><strong style="color: var(--mfu-green);">91%</strong></td>
                                <td> 4.5/5.0</td>
                                <td><span class="status-badge status-completed">ดีเยี่ยม / Excellent</span></td>
                            </tr>
                            <tr>
                                <td><strong>กุมารเวชกรรม</strong><br><span style="font-size: 0.95rem; color: var(--text-secondary);">Pediatrics</span></td>
                                <td><strong style="font-size: 1.25rem;">892</strong></td>
                                <td>18.7 นาที / min</td>
                                <td><strong style="color: var(--mfu-green);">93%</strong></td>
                                <td> 4.6/5.0</td>
                                <td><span class="status-badge status-completed">ดีเยี่ยม / Excellent</span></td>
                            </tr>
                            <tr>
                                <td><strong>สูติ-นรีเวชกรรม</strong><br><span style="font-size: 0.95rem; color: var(--text-secondary);">OB-GYN</span></td>
                                <td><strong style="font-size: 1.25rem;">634</strong></td>
                                <td>20.5 นาที / min</td>
                                <td><strong style="color: var(--gold-nav);">87%</strong></td>
                                <td> 4.4/5.0</td>
                                <td><span class="status-badge status-waiting">ดี / Good</span></td>
                            </tr>
                            <tr>
                                <td><strong>ทันตกรรม</strong><br><span style="font-size: 0.95rem; color: var(--text-secondary);">Dentistry</span></td>
                                <td><strong style="font-size: 1.25rem;">589</strong></td>
                                <td>25.8 นาที / min</td>
                                <td><strong style="color: var(--gold-nav);">85%</strong></td>
                                <td> 4.3/5.0</td>
                                <td><span class="status-badge status-waiting">ดี / Good</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- AI Performance Metrics -->
            <div class="card-grid" style="margin-top: 2rem;">
                <div class="card">
                    <h3 class="text-mfu-green"> AI Wait-Time Prediction</h3>
                    <div style="margin-top: 1.5rem;">
                        <div style="display: flex; justify-content: space-between; padding: 0.75rem 0; border-bottom: 1px solid var(--border-gray);">
                            <span>ความแม่นยำ / Accuracy:</span>
                            <strong style="font-size: 1.25rem; color: var(--mfu-green);">94.2%</strong>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: 0.75rem 0; border-bottom: 1px solid var(--border-gray);">
                            <span>ข้อผิดพลาดเฉลี่ย / Avg Error:</span>
                            <strong style="font-size: 1.25rem;">±2.3 นาที</strong>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: 0.75rem 0; border-bottom: 1px solid var(--border-gray);">
                            <span>การทำนายทั้งหมด / Predictions:</span>
                            <strong style="font-size: 1.25rem;">3,847</strong>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: 0.75rem 0;">
                            <span>โมเดลเวอร์ชัน / Model Version:</span>
                            <strong style="font-size: 1.25rem;">v2.4.1</strong>
                        </div>
                    </div>
                    <button class="btn btn-primary" style="width: 100%; margin-top: 1rem;" onclick="viewAIDetails()">
                        ดูรายละเอียด / View Details
                    </button>
                </div>

                <div class="card">
                    <h3 class="text-mfu-green"> Patient Flow Analysis</h3>
                    <div style="margin-top: 1.5rem;">
                        <div style="display: flex; justify-content: space-between; padding: 0.75rem 0; border-bottom: 1px solid var(--border-gray);">
                            <span>ช่วงเวลาผู้ป่วยสูงสุด / Peak Hours:</span>
                            <strong style="font-size: 1.25rem;">09:00-11:00</strong>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: 0.75rem 0; border-bottom: 1px solid var(--border-gray);">
                            <span>ผู้ป่วยต่อวัน / Daily Avg:</span>
                            <strong style="font-size: 1.25rem;">142 คน</strong>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: 0.75rem 0; border-bottom: 1px solid var(--border-gray);">
                            <span>Throughput Rate:</span>
                            <strong style="font-size: 1.25rem; color: var(--mfu-green);">3.6/hr</strong>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: 0.75rem 0;">
                            <span>Bottleneck Detection:</span>
                            <strong style="font-size: 1.25rem; color: var(--mfu-green);">None</strong>
                        </div>
                    </div>
                    <button class="btn btn-primary" style="width: 100%; margin-top: 1rem;" onclick="viewFlowAnalysis()">
                        ดูรายละเอียด / View Details
                    </button>
                </div>
            </div>

            <!-- Monthly Trends -->
            <div class="card" style="margin-top: 2rem;">
                <div class="card-header">
                    <h3 class="card-title">แนวโน้มรายเดือน / Monthly Trends</h3>
                </div>
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 2rem; text-align: center; margin-top: 1rem;">
                    <div>
                        <div style="font-size: 1rem; color: var(--text-secondary); margin-bottom: 0.5rem;">สัปดาห์ที่ 1 / Week 1</div>
                        <div style="font-size: 2rem; font-weight: 700; color: var(--mfu-green);">912</div>
                        <div style="font-size: 0.875rem; color: var(--text-secondary);">ผู้ป่วย / Patients</div>
                        <div style="margin-top: 0.5rem;">
                            <div style="background-color: var(--bg-gray); height: 80px; border-radius: 4px; display: flex; align-items: flex-end; overflow: hidden;">
                                <div style="background: linear-gradient(to top, var(--mfu-green), var(--mfu-green-light)); width: 100%; height: 75%;"></div>
                            </div>
                        </div>
                    </div>
                    <div>
                        <div style="font-size: 1rem; color: var(--text-secondary); margin-bottom: 0.5rem;">สัปดาห์ที่ 2 / Week 2</div>
                        <div style="font-size: 2rem; font-weight: 700; color: var(--mfu-green);">1,045</div>
                        <div style="font-size: 0.875rem; color: var(--text-secondary);">ผู้ป่วย / Patients</div>
                        <div style="margin-top: 0.5rem;">
                            <div style="background-color: var(--bg-gray); height: 80px; border-radius: 4px; display: flex; align-items: flex-end; overflow: hidden;">
                                <div style="background: linear-gradient(to top, var(--mfu-green), var(--mfu-green-light)); width: 100%; height: 90%;"></div>
                            </div>
                        </div>
                    </div>
                    <div>
                        <div style="font-size: 1rem; color: var(--text-secondary); margin-bottom: 0.5rem;">สัปดาห์ที่ 3 / Week 3</div>
                        <div style="font-size: 2rem; font-weight: 700; color: var(--mfu-green);">978</div>
                        <div style="font-size: 0.875rem; color: var(--text-secondary);">ผู้ป่วย / Patients</div>
                        <div style="margin-top: 0.5rem;">
                            <div style="background-color: var(--bg-gray); height: 80px; border-radius: 4px; display: flex; align-items: flex-end; overflow: hidden;">
                                <div style="background: linear-gradient(to top, var(--mfu-green), var(--mfu-green-light)); width: 100%; height: 82%;"></div>
                            </div>
                        </div>
                    </div>
                    <div>
                        <div style="font-size: 1rem; color: var(--text-secondary); margin-bottom: 0.5rem;">สัปดาห์ที่ 4 / Week 4</div>
                        <div style="font-size: 2rem; font-weight: 700; color: var(--gold-nav);">912</div>
                        <div style="font-size: 0.875rem; color: var(--text-secondary);">คาดการณ์ / Forecast</div>
                        <div style="margin-top: 0.5rem;">
                            <div style="background-color: var(--bg-gray); height: 80px; border-radius: 4px; display: flex; align-items: flex-end; overflow: hidden;">
                                <div style="background: linear-gradient(to top, var(--gold-nav), var(--mustard)); width: 100%; height: 75%; opacity: 0.6; border: 2px dashed var(--gold-nav);"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Alerts and Recommendations -->
            <div class="card" style="margin-top: 2rem;">
                <div class="card-header">
                    <h3 class="card-title">การแจ้งเตือนและคำแนะนำ / Alerts & Recommendations</h3>
                </div>
                <div>
                    <div class="alert alert-success" style="margin-bottom: 1rem;">
                        <div>
                            <strong>ประสิทธิภาพดีเยี่ยม / Excellent Performance:</strong><br>
                            ระบบทำงานได้ดีเยี่ยมในเดือนนี้ เวลารอคอยลดลง 18% / System performed excellently this month with 18% reduction in wait times
                        </div>
                    </div>
                    <div class="alert alert-info" style="margin-bottom: 1rem;">
                        <div>
                            <strong>คำแนะนำ / Recommendation:</strong><br>
                            พิจารณาเพิ่มบุคลากรในช่วง 09:00-11:00 เพื่อรองรับผู้ป่วยในช่วงเวลาเร่งด่วน / Consider adding staff during 09:00-11:00 peak hours
                        </div>
                    </div>
                    <div class="alert alert-warning">
                        <div>
                            <strong>ต้องติดตาม / Needs Attention:</strong><br>
                            แผนกทันตกรรมมีเวลารอคอยสูงกว่าเป้าหมาย 5 นาที / Dentistry department wait time is 5 minutes above target
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div style="margin-top: 2rem; display: flex; gap: 1rem; flex-wrap: wrap;">
                <button class="btn btn-primary" onclick="generateFullReport()">
                     รายงานแบบเต็ม / Full Report
                </button>
                <button class="btn btn-gold" onclick="exportData()">
                     ส่งออกข้อมูล / Export Data
                </button>
                <button class="btn btn-secondary" onclick="scheduleReport()">
                     ตั้งค่ารายงานอัตโนมัติ / Schedule Reports
                </button>
                <button class="btn btn-secondary" onclick="viewHistoricalData()">
                     ข้อมูลย้อนหลัง / Historical Data
                </button>
            </div>
        </main>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div>
                <h4>Patient Flow Analytics System</h4>
                <p>Mae Fah Luang University Medical Center Hospital</p>
            </div>
            <div>
                <h4>ติดต่อเรา / Contact</h4>
                <p>โทร: 053-916-999</p>
                <p>Email: info@mfumch.ac.th</p>
            </div>
            <div>
                <h4>Quick Links</h4>
                <p><a href="#">Analytics Guide</a></p>
                <p><a href="#">System Manual</a></p>
            </div>
            <div>
                <h4>ระบบ / System</h4>
                <p>Version 1.0.0</p>
                <p>© 2026 MFU Medical Center</p>
            </div>
        </div>
    </footer>

    <script>
        // Check if user is logged in
        if (sessionStorage.getItem('loggedIn') !== 'true' || sessionStorage.getItem('userRole') !== 'admin') {
            window.location.href = 'login.html?role=admin';
        }

        // Display user name
        document.getElementById('userName').textContent = sessionStorage.getItem('userId');

        // Logout function
        function logout() {
            if (confirm('ต้องการออกจากระบบหรือไม่? / Do you want to logout?')) {
                sessionStorage.clear();
                window.location.href = 'index.html';
            }
        }

        // Change period
        function changePeriod(period) {
            alert(`กำลังโหลดข้อมูล ${period} / Loading ${period} data...`);
            // In real implementation, this would fetch data for the selected period
        }

        // Export report
        function exportReport() {
            alert('กำลังส่งออกรายงาน... / Exporting report...\n\nรายงานจะถูกดาวน์โหลดเป็นไฟล์ PDF / Report will be downloaded as PDF');
        }

        // Generate full report
        function generateFullReport() {
            alert('กำลังสร้างรายงานแบบเต็ม... / Generating full report...\n\nรายงานครบถ้วนรวม:\n- Patient Flow Analytics\n- Performance Metrics\n- AI Predictions\n- Department Comparisons');
        }

        // Export data
        function exportData() {
            alert('เลือกรูปแบบการส่งออก / Select export format:\n\n- Excel (.xlsx)\n- CSV\n- JSON\n- PDF Report');
        }

        // Schedule report
        function scheduleReport() {
            alert('ตั้งค่ารายงานอัตโนมัติ / Schedule automated reports:\n\n- รายวัน (Daily)\n- รายสัปดาห์ (Weekly)\n- รายเดือน (Monthly)');
        }

        // View historical data
        function viewHistoricalData() {
            alert('ดูข้อมูลย้อนหลัง / View historical data:\n\n- 3 เดือนที่แล้ว\n- 6 เดือนที่แล้ว\n- 1 ปีที่แล้ว\n- Custom range');
        }

        // View AI details
        function viewAIDetails() {
            alert('รายละเอียด AI Model / AI Model Details:\n\n- Model: XGBoost v2.4.1\n- Training Data: 50,000+ records\n- Features: 24 variables\n- Update Frequency: Weekly\n- Last Updated: Feb 12, 2026');
        }

        // View flow analysis
        function viewFlowAnalysis() {
            alert('Patient Flow Analysis:\n\n- Peak hours identification\n- Bottleneck detection\n- Resource utilization\n- Wait time optimization\n- Queue predictions');
        }

        // Auto-refresh data every 30 seconds (in a real implementation)
        setInterval(function() {
            console.log('Auto-refreshing dashboard data...');
            // In real implementation, fetch updated data from API
        }, 30000);

        // Show Executive Dashboard
        function showExecutiveDashboard() {
            // Update active state in sidebar
            document.getElementById('overviewLink').classList.add('active');
            document.getElementById('analyticsLink').classList.remove('active');
            document.getElementById('createUserLink').classList.remove('active');
            
            // Ensure main content is visible
            const mainContent = document.getElementById('mainContent');
            mainContent.style.display = 'block';
            
            // Scroll to top
            window.scrollTo(0, 0);
            
            console.log('Executive Dashboard view activated');
        }

        // Show Patient Options Modal
        function showPatientOptions() {
            const modal = document.createElement('div');
            modal.innerHTML = `
                <div style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 9999; display: flex; align-items: center; justify-content: center;" onclick="this.remove()">
                    <div style="background: white; border-radius: 12px; padding: 2.5rem; max-width: 800px; width: 90%; max-height: 90vh; overflow-y: auto;" onclick="event.stopPropagation()">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                            <h2 style="color: var(--mfu-green); margin: 0;">ตรวจสอบผู้ป่วย / Check Patient</h2>
                            <button onclick="this.closest('div[style*=fixed]').remove()" style="background: none; border: none; font-size: 2rem; cursor: pointer; color: var(--text-secondary);">×</button>
                        </div>
                        
                        <p style="color: var(--text-secondary); margin-bottom: 2rem;">เลือกประเภทการตรวจสอบผู้ป่วย / Select patient check type:</p>
                        
                        <div style="display: grid; gap: 1.5rem;">
                            <!-- Wait Time Prediction Dashboard -->
                            <div class="card" onclick="showWaitTimePrediction()" style="cursor: pointer; border: 2px solid var(--border-gray); transition: all 0.3s; background: linear-gradient(135deg, #f0f9ff 0%, #ffffff 100%);" onmouseover="this.style.borderColor='#3B82F6'; this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(59, 130, 246, 0.2)';" onmouseout="this.style.borderColor='var(--border-gray)'; this.style.transform='translateY(0)'; this.style.boxShadow='none';">
                                <div style="display: flex; align-items: center; gap: 1.5rem;">
                                    <div style="flex: 1;">
                                        <h3 style="color: #3B82F6; margin: 0 0 0.5rem 0;">การทำนายเวลารอ / Wait Time Prediction</h3>
                                        <p style="margin: 0; color: var(--text-secondary); font-size: 0.95rem;">แดชบอร์ดการทำนายเวลารอคอยด้วย AI พร้อมสถิติแบบเรียลไทม์</p>
                                        <p style="margin: 0.5rem 0 0 0; color: var(--text-secondary); font-size: 0.95rem;">Dashboard with AI-powered wait time predictions and real-time statistics</p>
                                    </div>
                                    <div style="flex-shrink: 0; font-size: 1.5rem; color: #3B82F6;">→</div>
                                </div>
                            </div>
                            
                            <!-- Patient Screen & Tracking -->
                            <div class="card" onclick="showPatientTracking()" style="cursor: pointer; border: 2px solid var(--border-gray); transition: all 0.3s; background: linear-gradient(135deg, #fef3c7 0%, #ffffff 100%);" onmouseover="this.style.borderColor='var(--gold-nav)'; this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(184, 134, 11, 0.2)';" onmouseout="this.style.borderColor='var(--border-gray)'; this.style.transform='translateY(0)'; this.style.boxShadow='none';">
                                <div style="display: flex; align-items: center; gap: 1.5rem;">
                                    <div style="flex: 1;">
                                        <h3 style="color: var(--gold-nav); margin: 0 0 0.5rem 0;">หน้าจอและการติดตาม / Screen & Tracking</h3>
                                        <p style="margin: 0; color: var(--text-secondary); font-size: 0.95rem;">ติดตามสถานะผู้ป่วยแบบเรียลไทม์พร้อมหน้าจอแสดงผล</p>
                                        <p style="margin: 0.5rem 0 0 0; color: var(--text-secondary); font-size: 0.95rem;">Real-time patient status tracking with display screen</p>
                                    </div>
                                    <div style="flex-shrink: 0; font-size: 1.5rem; color: var(--gold-nav);">→</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // Show Wait Time Prediction Dashboard
        function showWaitTimePrediction() {
            // Close the patient options modal first
            const existingModal = document.querySelector('div[style*="position: fixed"]');
            if (existingModal) existingModal.remove();
            
            const modal = document.createElement('div');
            modal.innerHTML = `
                <div style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 9999; display: flex; align-items: center; justify-content: center;" onclick="this.remove()">
                    <div style="background: white; border-radius: 12px; padding: 2.5rem; max-width: 1000px; width: 90%; max-height: 90vh; overflow-y: auto;" onclick="event.stopPropagation()">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                            <h2 style="color: var(--mfu-green); margin: 0;">การทำนายเวลารอคอย / Wait Time Prediction Dashboard</h2>
                            <button onclick="this.closest('div[style*=fixed]').remove()" style="background: none; border: none; font-size: 2rem; cursor: pointer; color: var(--text-secondary);">×</button>
                        </div>
                        
                        <div style="background: linear-gradient(135deg, #f0fdf4 0%, #ffffff 100%); border-radius: 8px; padding: 1.5rem; margin-bottom: 1.5rem;">
                            <h3 style="color: var(--mfu-green); margin-bottom: 1rem;">AI Wait-Time Prediction Dashboard</h3>
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; margin-bottom: 1rem;">
                                <div style="text-align: center; padding: 1rem; background: white; border-radius: 8px;">
                                    <div style="font-size: 2rem; font-weight: 700; color: var(--gold-nav);">16.8</div>
                                    <div style="font-size: 0.95rem; color: var(--text-secondary);">เวลารอเฉลี่ย / Avg Wait (min)</div>
                                </div>
                                <div style="text-align: center; padding: 1rem; background: white; border-radius: 8px;">
                                    <div style="font-size: 2rem; font-weight: 700; color: #3B82F6;">24</div>
                                    <div style="font-size: 0.95rem; color: var(--text-secondary);">ผู้ป่วยในคิว / In Queue</div>
                                </div>
                                <div style="text-align: center; padding: 1rem; background: white; border-radius: 8px;">
                                    <div style="font-size: 2rem; font-weight: 700; color: var(--mfu-green);">94.2%</div>
                                    <div style="font-size: 0.95rem; color: var(--text-secondary);">ความแม่นยำ AI / Accuracy</div>
                                </div>
                            </div>
                        </div>

                        <h3 style="color: var(--mfu-green); margin-bottom: 1rem;">รายการผู้ป่วยพร้อมการทำนาย / Patient List with Predictions</h3>
                        <table style="width: 100%; border-collapse: collapse;">
                            <thead style="background: var(--mfu-green); color: white;">
                                <tr>
                                    <th style="padding: 0.75rem; text-align: left;">HN</th>
                                    <th style="padding: 0.75rem; text-align: left;">ชื่อ-นามสกุล / Name</th>
                                    <th style="padding: 0.75rem; text-align: center;">แผนก / Dept</th>
                                    <th style="padding: 0.75rem; text-align: center;">เวลาที่เข้า / Check-in</th>
                                    <th style="padding: 0.75rem; text-align: center;">เวลารอคาด / Pred Wait</th>
                                    <th style="padding: 0.75rem; text-align: center;">สถานะ / Status</th>
                                </tr>
                            </thead>
                            <tbody style="background: white;">
                                <tr style="border-bottom: 1px solid var(--border-gray);">
                                    <td style="padding: 0.75rem;">HN001</td>
                                    <td style="padding: 0.75rem;">นางสมศรี ใจดี</td>
                                    <td style="padding: 0.75rem; text-align: center;">OPD</td>
                                    <td style="padding: 0.75rem; text-align: center;">09:15</td>
                                    <td style="padding: 0.75rem; text-align: center;"><strong style="color: var(--mfu-green);">12 min</strong></td>
                                    <td style="padding: 0.75rem; text-align: center;"><span style="background: #fef3c7; color: #92400e; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.875rem;">Waiting</span></td>
                                </tr>
                                <tr style="border-bottom: 1px solid var(--border-gray);">
                                    <td style="padding: 0.75rem;">HN002</td>
                                    <td style="padding: 0.75rem;">นายสมชาย รักษ์ดี</td>
                                    <td style="padding: 0.75rem; text-align: center;">ศัลยกรรม</td>
                                    <td style="padding: 0.75rem; text-align: center;">09:30</td>
                                    <td style="padding: 0.75rem; text-align: center;"><strong style="color: #3B82F6;">18 min</strong></td>
                                    <td style="padding: 0.75rem; text-align: center;"><span style="background: #dbeafe; color: #1e40af; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.875rem;">In Treatment</span></td>
                                </tr>
                                <tr style="border-bottom: 1px solid var(--border-gray);">
                                    <td style="padding: 0.75rem;">HN003</td>
                                    <td style="padding: 0.75rem;">นางสาวมาลี สุขใจ</td>
                                    <td style="padding: 0.75rem; text-align: center;">กุมาร</td>
                                    <td style="padding: 0.75rem; text-align: center;">09:45</td>
                                    <td style="padding: 0.75rem; text-align: center;"><strong style="color: var(--mfu-green);">15 min</strong></td>
                                    <td style="padding: 0.75rem; text-align: center;"><span style="background: #fef3c7; color: #92400e; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.875rem;">Waiting</span></td>
                                </tr>
                                <tr style="border-bottom: 1px solid var(--border-gray);">
                                    <td style="padding: 0.75rem;">HN004</td>
                                    <td style="padding: 0.75rem;">John Smith</td>
                                    <td style="padding: 0.75rem; text-align: center;">OPD</td>
                                    <td style="padding: 0.75rem; text-align: center;">10:00</td>
                                    <td style="padding: 0.75rem; text-align: center;"><strong style="color: var(--gold-nav);">22 min</strong></td>
                                    <td style="padding: 0.75rem; text-align: center;"><span style="background: #fef3c7; color: #92400e; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.875rem;">Waiting</span></td>
                                </tr>
                            </tbody>
                        </table>

                        <div style="margin-top: 1.5rem; padding: 1rem; background: #f0f9ff; border-radius: 8px; border-left: 4px solid #3B82F6;">
                            <strong style="color: #1e40af;">หมายเหตุ / Note:</strong>
                            <p style="margin: 0.5rem 0 0 0; color: var(--text-secondary); font-size: 0.95rem;">
                                เวลารอที่คาดการณ์คำนวณโดย AI จากปัจจัยต่างๆ เช่น จำนวนผู้ป่วย, ประเภทการรักษา, และประสิทธิภาพแผนก<br>
                                <em>Wait time predictions calculated by AI based on patient volume, treatment type, and department efficiency</em>
                            </p>
                        </div>

                        <button class="btn btn-primary" onclick="this.closest('div[style*=fixed]').remove()" style="width: 100%; margin-top: 1.5rem; padding: 1rem;">
                            ปิด / Close
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // Show Patient Tracking
        function showPatientTracking() {
            // Close the patient options modal first
            const existingModal = document.querySelector('div[style*="position: fixed"]');
            if (existingModal) existingModal.remove();
            
            const modal = document.createElement('div');
            modal.innerHTML = `
                <div style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 9999; display: flex; align-items: center; justify-content: center;" onclick="this.remove()">
                    <div style="background: white; border-radius: 12px; padding: 2.5rem; max-width: 1000px; width: 90%; max-height: 90vh; overflow-y: auto;" onclick="event.stopPropagation()">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                            <h2 style="color: var(--mfu-green); margin: 0;">หน้าจอและการติดตาม / Patient Screen & Tracking</h2>
                            <button onclick="this.closest('div[style*=fixed]').remove()" style="background: none; border: none; font-size: 2rem; cursor: pointer; color: var(--text-secondary);">×</button>
                        </div>
                        
                        <div style="background: linear-gradient(135deg, #fef3c7 0%, #ffffff 100%); border-radius: 8px; padding: 1.5rem; margin-bottom: 1.5rem;">
                            <h3 style="color: var(--gold-nav); margin-bottom: 1rem;">Patient Display Screen</h3>
                            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem;">
                                <div style="text-align: center; padding: 1rem; background: white; border-radius: 8px;">
                                    <div style="font-size: 2rem; font-weight: 700; color: #3B82F6;">8</div>
                                    <div style="font-size: 0.95rem; color: var(--text-secondary);">กำลังรักษา / In Treatment</div>
                                </div>
                                <div style="text-align: center; padding: 1rem; background: white; border-radius: 8px;">
                                    <div style="font-size: 2rem; font-weight: 700; color: var(--mfu-green);">142</div>
                                    <div style="font-size: 0.95rem; color: var(--text-secondary);">เสร็จวันนี้ / Completed Today</div>
                                </div>
                            </div>
                        </div>

                        <h3 style="color: var(--mfu-green); margin-bottom: 1rem;">การติดตามแบบเรียลไทม์ / Real-Time Tracking</h3>
                        
                        <div style="display: grid; gap: 1rem; margin-bottom: 1.5rem;">
                            <div style="border: 2px solid var(--mfu-green); border-radius: 8px; padding: 1rem; background: #f0fdf4;">
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <div>
                                        <div style="font-weight: 700; color: var(--mfu-green); font-size: 1.125rem;">ห้อง 101 / Room 101</div>
                                        <div style="margin-top: 0.5rem; color: var(--text-secondary);">นายสมชาย รักษ์ดี (HN002)</div>
                                    </div>
                                    <div style="text-align: right;">
                                        <span style="background: var(--mfu-green); color: white; padding: 0.5rem 1rem; border-radius: 8px; font-weight: 600;">กำลังตรวจ / In Progress</span>
                                        <div style="margin-top: 0.5rem; color: var(--text-secondary); font-size: 0.875rem;">นพ. สมชาย ใจดี</div>
                                    </div>
                                </div>
                                <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid var(--border-gray);">
                                    <div style="display: flex; gap: 2rem; font-size: 0.875rem;">
                                        <div><strong>เข้าห้อง:</strong> 09:30</div>
                                        <div><strong>เวลาที่ใช้:</strong> 18 นาที</div>
                                        <div><strong>แผนก:</strong> ศัลยกรรม</div>
                                    </div>
                                </div>
                            </div>

                            <div style="border: 2px solid #3B82F6; border-radius: 8px; padding: 1rem; background: #f0f9ff;">
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <div>
                                        <div style="font-weight: 700; color: #3B82F6; font-size: 1.125rem;">ห้อง 102 / Room 102</div>
                                        <div style="margin-top: 0.5rem; color: var(--text-secondary);">นางสาวมาลี สุขใจ (HN003)</div>
                                    </div>
                                    <div style="text-align: right;">
                                        <span style="background: #3B82F6; color: white; padding: 0.5rem 1rem; border-radius: 8px; font-weight: 600;">กำลังตรวจ / In Progress</span>
                                        <div style="margin-top: 0.5rem; color: var(--text-secondary); font-size: 0.875rem;">พญ. มาลี สุขใจ</div>
                                    </div>
                                </div>
                                <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid var(--border-gray);">
                                    <div style="display: flex; gap: 2rem; font-size: 0.875rem;">
                                        <div><strong>เข้าห้อง:</strong> 09:45</div>
                                        <div><strong>เวลาที่ใช้:</strong> 15 นาที</div>
                                        <div><strong>แผนก:</strong> กุมารเวชกรรม</div>
                                    </div>
                                </div>
                            </div>

                            <div style="border: 2px solid var(--border-gray); border-radius: 8px; padding: 1rem; background: #f9fafb;">
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <div>
                                        <div style="font-weight: 700; color: var(--text-secondary); font-size: 1.125rem;">ห้อง 103 / Room 103</div>
                                        <div style="margin-top: 0.5rem; color: var(--text-secondary);">--</div>
                                    </div>
                                    <div style="text-align: right;">
                                        <span style="background: #6B7280; color: white; padding: 0.5rem 1rem; border-radius: 8px; font-weight: 600;">ว่าง / Available</span>
                                        <div style="margin-top: 0.5rem; color: var(--text-secondary); font-size: 0.875rem;">พร้อมให้บริการ</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div style="margin-top: 1.5rem; padding: 1rem; background: #fef3c7; border-radius: 8px; border-left: 4px solid var(--gold-nav);">
                            <strong style="color: #92400e;">ข้อมูลเรียลไทม์ / Real-Time Information:</strong>
                            <p style="margin: 0.5rem 0 0 0; color: var(--text-secondary); font-size: 0.95rem;">
                                หน้าจอนี้แสดงสถานะการตรวจของผู้ป่วยแบบเรียลไทม์ในแต่ละห้อง สามารถติดตามความคืบหน้าและเวลาที่ใช้ได้<br>
                                <em>This screen shows real-time patient examination status in each room with progress and time tracking</em>
                            </p>
                        </div>

                        <button class="btn btn-primary" onclick="this.closest('div[style*=fixed]').remove()" style="width: 100%; margin-top: 1.5rem; padding: 1rem;">
                            ปิด / Close
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // Show Doctor Room Performance Dashboard
        function showDoctorRoomPerformance() {
            const modal = document.createElement('div');
            modal.innerHTML = `
                <div style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 9999; display: flex; align-items: center; justify-content: center;" onclick="this.remove()">
                    <div style="background: white; border-radius: 12px; padding: 2.5rem; max-width: 1100px; width: 90%; max-height: 90vh; overflow-y: auto;" onclick="event.stopPropagation()">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                            <h2 style="color: var(--mfu-green); margin: 0;">ประสิทธิภาพห้องตรวจ / Doctor Room Performance</h2>
                            <button onclick="this.closest('div[style*=fixed]').remove()" style="background: none; border: none; font-size: 2rem; cursor: pointer; color: var(--text-secondary);">×</button>
                        </div>
                        
                        <div style="background: linear-gradient(135deg, #f0f9ff 0%, #ffffff 100%); border-radius: 8px; padding: 1.5rem; margin-bottom: 1.5rem;">
                            <h3 style="color: #3B82F6; margin-bottom: 1rem;">สถิติภาพรวม / Overall Statistics</h3>
                            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 1rem;">
                                <div style="text-align: center; padding: 1rem; background: white; border-radius: 8px;">
                                    <div style="font-size: 2rem; font-weight: 700; color: var(--mfu-green);">15</div>
                                    <div style="font-size: 0.95rem; color: var(--text-secondary);">ห้องทั้งหมด / Total Rooms</div>
                                </div>
                                <div style="text-align: center; padding: 1rem; background: white; border-radius: 8px;">
                                    <div style="font-size: 2rem; font-weight: 700; color: #3B82F6;">12</div>
                                    <div style="font-size: 0.95rem; color: var(--text-secondary);">กำลังใช้งาน / Active</div>
                                </div>
                                <div style="text-align: center; padding: 1rem; background: white; border-radius: 8px;">
                                    <div style="font-size: 2rem; font-weight: 700; color: var(--gold-nav);">14.5</div>
                                    <div style="font-size: 0.95rem; color: var(--text-secondary);">เวลาเฉลี่ย / Avg Time (min)</div>
                                </div>
                                <div style="text-align: center; padding: 1rem; background: white; border-radius: 8px;">
                                    <div style="font-size: 2rem; font-weight: 700; color: #10B981;">147</div>
                                    <div style="font-size: 0.95rem; color: var(--text-secondary);">ผู้ป่วยวันนี้ / Today</div>
                                </div>
                            </div>
                        </div>

                        <h3 style="color: var(--mfu-green); margin-bottom: 1rem;">ประสิทธิภาพห้องตรวจแต่ละห้อง / Room Performance</h3>
                        <table style="width: 100%; border-collapse: collapse;">
                            <thead style="background: var(--mfu-green); color: white;">
                                <tr>
                                    <th style="padding: 0.75rem; text-align: left;">ห้อง / Room</th>
                                    <th style="padding: 0.75rem; text-align: left;">แพทย์ / Doctor</th>
                                    <th style="padding: 0.75rem; text-align: center;">แผนก / Dept</th>
                                    <th style="padding: 0.75rem; text-align: center;">ผู้ป่วย / Patients</th>
                                    <th style="padding: 0.75rem; text-align: center;">เวลาเฉลี่ย / Avg Time</th>
                                    <th style="padding: 0.75rem; text-align: center;">ประสิทธิภาพ / Performance</th>
                                    <th style="padding: 0.75rem; text-align: center;">สถานะ / Status</th>
                                </tr>
                            </thead>
                            <tbody style="background: white;">
                                <tr style="border-bottom: 1px solid var(--border-gray); background: #f0fdf4;">
                                    <td style="padding: 0.75rem; font-weight: 700;">Room 101</td>
                                    <td style="padding: 0.75rem;">นพ. สมชาย ใจดี</td>
                                    <td style="padding: 0.75rem; text-align: center;">OPD</td>
                                    <td style="padding: 0.75rem; text-align: center;">18</td>
                                    <td style="padding: 0.75rem; text-align: center;"><strong style="color: var(--mfu-green);">8.5 min</strong></td>
                                    <td style="padding: 0.75rem; text-align: center;">
                                        <span style="background: #d1fae5; color: #065f46; padding: 0.5rem 1rem; border-radius: 8px; font-weight: 600;">FAST</span>
                                    </td>
                                    <td style="padding: 0.75rem; text-align: center;">
                                        <div style="width: 12px; height: 12px; background: #10B981; border-radius: 50%; margin: 0 auto;"></div>
                                    </td>
                                </tr>
                                <tr style="border-bottom: 1px solid var(--border-gray); background: #f0fdf4;">
                                    <td style="padding: 0.75rem; font-weight: 700;">Room 105</td>
                                    <td style="padding: 0.75rem;">พญ. สุดา รักษ์ดี</td>
                                    <td style="padding: 0.75rem; text-align: center;">กุมาร</td>
                                    <td style="padding: 0.75rem; text-align: center;">15</td>
                                    <td style="padding: 0.75rem; text-align: center;"><strong style="color: var(--mfu-green);">9.2 min</strong></td>
                                    <td style="padding: 0.75rem; text-align: center;">
                                        <span style="background: #d1fae5; color: #065f46; padding: 0.5rem 1rem; border-radius: 8px; font-weight: 600;">FAST</span>
                                    </td>
                                    <td style="padding: 0.75rem; text-align: center;">
                                        <div style="width: 12px; height: 12px; background: #10B981; border-radius: 50%; margin: 0 auto;"></div>
                                    </td>
                                </tr>
                                <tr style="border-bottom: 1px solid var(--border-gray);">
                                    <td style="padding: 0.75rem; font-weight: 700;">Room 103</td>
                                    <td style="padding: 0.75rem;">นพ. วิชัย สุขสม</td>
                                    <td style="padding: 0.75rem; text-align: center;">ศัลยกรรม</td>
                                    <td style="padding: 0.75rem; text-align: center;">12</td>
                                    <td style="padding: 0.75rem; text-align: center;"><strong style="color: #3B82F6;">12.8 min</strong></td>
                                    <td style="padding: 0.75rem; text-align: center;">
                                        <span style="background: #dbeafe; color: #1e40af; padding: 0.5rem 1rem; border-radius: 8px; font-weight: 600;">NORMAL</span>
                                    </td>
                                    <td style="padding: 0.75rem; text-align: center;">
                                        <div style="width: 12px; height: 12px; background: #3B82F6; border-radius: 50%; margin: 0 auto;"></div>
                                    </td>
                                </tr>
                                <tr style="border-bottom: 1px solid var(--border-gray);">
                                    <td style="padding: 0.75rem; font-weight: 700;">Room 107</td>
                                    <td style="padding: 0.75rem;">พญ. มาลี สวยงาม</td>
                                    <td style="padding: 0.75rem; text-align: center;">OPD</td>
                                    <td style="padding: 0.75rem; text-align: center;">14</td>
                                    <td style="padding: 0.75rem; text-align: center;"><strong style="color: #3B82F6;">14.1 min</strong></td>
                                    <td style="padding: 0.75rem; text-align: center;">
                                        <span style="background: #dbeafe; color: #1e40af; padding: 0.5rem 1rem; border-radius: 8px; font-weight: 600;">NORMAL</span>
                                    </td>
                                    <td style="padding: 0.75rem; text-align: center;">
                                        <div style="width: 12px; height: 12px; background: #3B82F6; border-radius: 50%; margin: 0 auto;"></div>
                                    </td>
                                </tr>
                                <tr style="border-bottom: 1px solid var(--border-gray);">
                                    <td style="padding: 0.75rem; font-weight: 700;">Room 102</td>
                                    <td style="padding: 0.75rem;">นพ. ประเสริฐ ดีเลิศ</td>
                                    <td style="padding: 0.75rem; text-align: center;">ศัลยกรรม</td>
                                    <td style="padding: 0.75rem; text-align: center;">10</td>
                                    <td style="padding: 0.75rem; text-align: center;"><strong style="color: #3B82F6;">15.3 min</strong></td>
                                    <td style="padding: 0.75rem; text-align: center;">
                                        <span style="background: #dbeafe; color: #1e40af; padding: 0.5rem 1rem; border-radius: 8px; font-weight: 600;">NORMAL</span>
                                    </td>
                                    <td style="padding: 0.75rem; text-align: center;">
                                        <div style="width: 12px; height: 12px; background: #3B82F6; border-radius: 50%; margin: 0 auto;"></div>
                                    </td>
                                </tr>
                                <tr style="border-bottom: 1px solid var(--border-gray); background: #fef3c7;">
                                    <td style="padding: 0.75rem; font-weight: 700;">Room 108</td>
                                    <td style="padding: 0.75rem;">นพ. ชัยวัฒน์ เก่งการ</td>
                                    <td style="padding: 0.75rem; text-align: center;">OPD</td>
                                    <td style="padding: 0.75rem; text-align: center;">9</td>
                                    <td style="padding: 0.75rem; text-align: center;"><strong style="color: var(--gold-nav);">18.7 min</strong></td>
                                    <td style="padding: 0.75rem; text-align: center;">
                                        <span style="background: #fef3c7; color: #92400e; padding: 0.5rem 1rem; border-radius: 8px; font-weight: 600;">SLOW</span>
                                    </td>
                                    <td style="padding: 0.75rem; text-align: center;">
                                        <div style="width: 12px; height: 12px; background: #F59E0B; border-radius: 50%; margin: 0 auto;"></div>
                                    </td>
                                </tr>
                                <tr style="border-bottom: 1px solid var(--border-gray); background: #fee2e2;">
                                    <td style="padding: 0.75rem; font-weight: 700;">Room 112</td>
                                    <td style="padding: 0.75rem;">พญ. อรุณี ช้าลง</td>
                                    <td style="padding: 0.75rem; text-align: center;">กุมาร</td>
                                    <td style="padding: 0.75rem; text-align: center;">7</td>
                                    <td style="padding: 0.75rem; text-align: center;"><strong style="color: #DC3545;">24.5 min</strong></td>
                                    <td style="padding: 0.75rem; text-align: center;">
                                        <span style="background: #fee2e2; color: #991b1b; padding: 0.5rem 1rem; border-radius: 8px; font-weight: 600;">LATE</span>
                                    </td>
                                    <td style="padding: 0.75rem; text-align: center;">
                                        <div style="width: 12px; height: 12px; background: #DC3545; border-radius: 50%; margin: 0 auto;"></div>
                                    </td>
                                </tr>
                                <tr style="border-bottom: 1px solid var(--border-gray); background: #fee2e2;">
                                    <td style="padding: 0.75rem; font-weight: 700;">Room 115</td>
                                    <td style="padding: 0.75rem;">นพ. สมหมาย ล่าช้า</td>
                                    <td style="padding: 0.75rem; text-align: center;">ศัลยกรรม</td>
                                    <td style="padding: 0.75rem; text-align: center;">6</td>
                                    <td style="padding: 0.75rem; text-align: center;"><strong style="color: #DC3545;">28.3 min</strong></td>
                                    <td style="padding: 0.75rem; text-align: center;">
                                        <span style="background: #fee2e2; color: #991b1b; padding: 0.5rem 1rem; border-radius: 8px; font-weight: 600;">LATE</span>
                                    </td>
                                    <td style="padding: 0.75rem; text-align: center;">
                                        <div style="width: 12px; height: 12px; background: #DC3545; border-radius: 50%; margin: 0 auto;"></div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                        <div style="margin-top: 1.5rem; display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem;">
                            <div style="padding: 1rem; background: #f0fdf4; border-radius: 8px; border-left: 4px solid #10B981;">
                                <div style="font-weight: 700; color: #065f46; margin-bottom: 0.5rem;">FAST - รวดเร็ว</div>
                                <div style="color: var(--text-secondary); font-size: 0.9rem;">&lt; 10 นาที / &lt; 10 minutes</div>
                                <div style="color: var(--text-secondary); font-size: 0.9rem; margin-top: 0.25rem;">2 ห้อง / 2 rooms</div>
                            </div>
                            <div style="padding: 1rem; background: #eff6ff; border-radius: 8px; border-left: 4px solid #3B82F6;">
                                <div style="font-weight: 700; color: #1e40af; margin-bottom: 0.5rem;">NORMAL - ปกติ</div>
                                <div style="color: var(--text-secondary); font-size: 0.9rem;">10-16 นาที / 10-16 minutes</div>
                                <div style="color: var(--text-secondary); font-size: 0.9rem; margin-top: 0.25rem;">3 ห้อง / 3 rooms</div>
                            </div>
                            <div style="padding: 1rem; background: #fef2f2; border-radius: 8px; border-left: 4px solid #DC3545;">
                                <div style="font-weight: 700; color: #991b1b; margin-bottom: 0.5rem;">SLOW/LATE - ช้า/ล่าช้า</div>
                                <div style="color: var(--text-secondary); font-size: 0.9rem;">&gt; 16 นาที / &gt; 16 minutes</div>
                                <div style="color: var(--text-secondary); font-size: 0.9rem; margin-top: 0.25rem;">3 ห้อง / 3 rooms</div>
                            </div>
                        </div>

                        <div style="margin-top: 1.5rem; padding: 1rem; background: #f0f9ff; border-radius: 8px; border-left: 4px solid #3B82F6;">
                            <strong style="color: #1e40af;">หมายเหตุ / Note:</strong>
                            <p style="margin: 0.5rem 0 0 0; color: var(--text-secondary); font-size: 0.95rem;">
                                ข้อมูลประสิทธิภาพคำนวณจากเวลาเฉลี่ยต่อผู้ป่วยในแต่ละห้องตรวจ สามารถใช้เพื่อปรับปรุงการให้บริการและจัดสรรทรัพยากร<br>
                                <em>Performance calculated from average time per patient in each examination room. Can be used to improve service and resource allocation</em>
                            </p>
                        </div>

                        <button class="btn btn-primary" onclick="this.closest('div[style*=fixed]').remove()" style="width: 100%; margin-top: 1.5rem; padding: 1rem;">
                            ปิด / Close
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // Show Create User Modal
        // Show Analytics Dashboard with AI Predictions
        function showAnalytics() {
            // Update active state in sidebar
            document.getElementById('overviewLink').classList.remove('active');
            document.getElementById('analyticsLink').classList.add('active');
            document.getElementById('createUserLink').classList.remove('active');
            
            // Generate AI prediction
            const currentMonthPatients = 3847;
            const historicalData = [
                { month: 'มกราคม / Jan', patients: 3234 },
                { month: 'กุมภาพันธ์ / Feb', patients: 3456 },
                { month: 'มีนาคม / Mar', patients: 3621 },
                { month: 'เมษายน / Apr', patients: 3589 },
                { month: 'พฤษภาคม / May', patients: 3712 },
                { month: 'มิถุนายน / Jun', patients: 3847 }
            ];
            
            // Simple AI prediction algorithm (linear regression with seasonal adjustment)
            const growthRate = 0.035; // 3.5% monthly growth
            const seasonalFactor = 1.08; // 8% increase for next month (peak season)
            const aiPrediction = Math.round(currentMonthPatients * (1 + growthRate) * seasonalFactor);
            const confidenceLevel = 94.2;
            
            // Calculate daily average
            const daysInNextMonth = 30;
            const predictedDailyAvg = Math.round(aiPrediction / daysInNextMonth);
            
            // Calculate resource needs
            const currentDoctors = 42;
            const predictedDoctorsNeeded = Math.ceil(currentDoctors * (aiPrediction / currentMonthPatients));
            const additionalDoctors = predictedDoctorsNeeded - currentDoctors;
            
            const mainContent = document.getElementById('mainContent');
            mainContent.innerHTML = `
                <div style="margin-bottom: 2rem;">
                    <button onclick="showExecutiveDashboard()" class="btn" style="background: var(--border-gray); color: var(--text-primary); padding: 0.5rem 1rem; margin-bottom: 1rem;">
                        ← กลับไปภาพรวม / Back to Overview
                    </button>
                    <h2 style="color: var(--mfu-green); margin: 0;">การวิเคราะห์และทำนายด้วย AI / AI Analytics & Predictions</h2>
                    <p style="color: var(--text-secondary); margin: 0.5rem 0 0 0;">ระบบวิเคราะห์และทำนายจำนวนผู้ป่วยด้วยปัญญาประดิษฐ์ / AI-powered patient prediction system</p>
                </div>

                <!-- AI Prediction Card -->
                <div class="card" style="background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%); border: 3px solid #3B82F6; margin-bottom: 2rem;">
                    <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1.5rem;">
                        <div>
                            <h3 style="color: #3B82F6; margin: 0 0 0.25rem 0; font-size: 1.5rem;">การทำนายผู้ป่วยเดือนหน้า / Next Month Prediction</h3>
                            <p style="margin: 0; color: var(--text-secondary);">ใช้อัลกอริทึม Machine Learning วิเคราะห์แนวโน้ม / ML-powered trend analysis</p>
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem; margin-bottom: 1.5rem;">
                        <div style="background: white; padding: 1.5rem; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <div style="color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 0.5rem;">จำนวนผู้ป่วยที่คาดการณ์</div>
                            <div style="font-size: 2.5rem; font-weight: 700; color: #3B82F6;">${aiPrediction.toLocaleString()}</div>
                            <div style="color: #10B981; font-size: 0.9rem; margin-top: 0.5rem;">↑ +${Math.round(((aiPrediction - currentMonthPatients) / currentMonthPatients) * 100)}% จากเดือนนี้</div>
                        </div>
                        
                        <div style="background: white; padding: 1.5rem; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <div style="color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 0.5rem;">ความแม่นยำของ AI</div>
                            <div style="font-size: 2.5rem; font-weight: 700; color: var(--mfu-green);">${confidenceLevel}%</div>
                            <div style="color: var(--text-secondary); font-size: 0.9rem; margin-top: 0.5rem;">Confidence Level</div>
                        </div>
                        
                        <div style="background: white; padding: 1.5rem; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <div style="color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 0.5rem;">เฉลี่ยต่อวัน</div>
                            <div style="font-size: 2.5rem; font-weight: 700; color: var(--gold-nav);">${predictedDailyAvg}</div>
                            <div style="color: var(--text-secondary); font-size: 0.9rem; margin-top: 0.5rem;">ผู้ป่วย / Patients</div>
                        </div>
                    </div>
                    
                    <div style="background: rgba(59, 130, 246, 0.1); padding: 1rem; border-radius: 8px; border-left: 4px solid #3B82F6;">
                        <div style="display: flex; align-items: center; gap: 0.75rem;">
                            <div style="width: 24px; height: 24px; background: #3B82F6; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.85rem; font-weight: 700; flex-shrink: 0;">i</div>
                            <div>
                                <strong style="color: #3B82F6;">วิธีการคำนวณ / Calculation Method:</strong>
                                <p style="margin: 0.5rem 0 0 0; color: var(--text-secondary); line-height: 1.6;">
                                    ระบบใช้ Linear Regression ร่วมกับ Seasonal Adjustment โดยวิเคราะห์จากข้อมูล 6 เดือนล่าสุด พร้อมปรับค่าตามฤดูกาล<br>
                                    <em style="font-size: 0.9rem;">Using Linear Regression with Seasonal Adjustment based on 6-month historical data</em>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Historical Trend -->
                <div class="card" style="margin-bottom: 2rem;">
                    <h3 style="color: var(--mfu-green); margin-bottom: 1.5rem;">แนวโน้มย้อนหลัง / Historical Trend</h3>
                    <div style="background: var(--bg-gray); padding: 2rem; border-radius: 8px;">
                        ${historicalData.map((data, index) => `
                            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem; padding: 1rem; background: white; border-radius: 6px;">
                                <div style="min-width: 150px; font-weight: 600; color: var(--text-primary);">${data.month}</div>
                                <div style="flex: 1; background: var(--bg-gray); border-radius: 4px; height: 30px; position: relative; overflow: hidden;">
                                    <div style="background: linear-gradient(90deg, var(--mfu-green) 0%, var(--mfu-green-light) 100%); height: 100%; width: ${(data.patients / 4000) * 100}%; border-radius: 4px; transition: width 1s ease;"></div>
                                </div>
                                <div style="min-width: 100px; text-align: right; font-weight: 700; color: var(--mfu-green);">${data.patients.toLocaleString()}</div>
                            </div>
                        `).join('')}
                        
                        <!-- Next Month Prediction -->
                        <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 0; padding: 1rem; background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%); border-radius: 6px; border: 2px solid #3B82F6;">
                            <div style="min-width: 150px; font-weight: 700; color: #3B82F6;">กรกฎาคม / Jul<br><span style="font-size: 0.85rem; font-weight: 400;">(คาดการณ์)</span></div>
                            <div style="flex: 1; background: rgba(59, 130, 246, 0.1); border-radius: 4px; height: 30px; position: relative; overflow: hidden;">
                                <div style="background: linear-gradient(90deg, #3B82F6 0%, #2563EB 100%); height: 100%; width: ${(aiPrediction / 4000) * 100}%; border-radius: 4px; animation: slideIn 1.5s ease;"></div>
                            </div>
                            <div style="min-width: 100px; text-align: right; font-weight: 700; color: #3B82F6;">${aiPrediction.toLocaleString()}</div>
                        </div>
                    </div>
                </div>

                <!-- Resource Planning -->
                <div class="card" style="background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%); border-left: 4px solid var(--mfu-green);">
                    <h3 style="color: var(--mfu-green); margin-bottom: 1.5rem;">การวางแผนทรัพยากร / Resource Planning</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem;">
                        <div style="background: white; padding: 1.5rem; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <div style="color: var(--text-secondary); margin-bottom: 0.5rem;">แพทย์ที่ต้องการ / Doctors Needed</div>
                            <div style="font-size: 2rem; font-weight: 700; color: var(--mfu-green);">${predictedDoctorsNeeded}</div>
                            <div style="margin-top: 0.5rem;">
                                <span style="color: ${additionalDoctors > 0 ? '#F59E0B' : '#10B981'}; font-weight: 600;">
                                    ${additionalDoctors > 0 ? `ต้องการเพิ่ม +${additionalDoctors} คน` : 'เพียงพอ'}
                                </span>
                            </div>
                        </div>
                        
                        <div style="background: white; padding: 1.5rem; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <div style="color: var(--text-secondary); margin-bottom: 0.5rem;">ห้องตรวจที่แนะนำ / Recommended Rooms</div>
                            <div style="font-size: 2rem; font-weight: 700; color: var(--gold-nav);">${Math.ceil(predictedDailyAvg / 15)}</div>
                            <div style="margin-top: 0.5rem; color: var(--text-secondary);">ห้อง / Rooms</div>
                        </div>
                        
                        <div style="background: white; padding: 1.5rem; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <div style="color: var(--text-secondary); margin-bottom: 0.5rem;">เวลารอโดยประมาณ / Est. Wait Time</div>
                            <div style="font-size: 2rem; font-weight: 700; color: #3B82F6;">${Math.round(16.8 * (aiPrediction / currentMonthPatients))}</div>
                            <div style="margin-top: 0.5rem; color: var(--text-secondary);">นาที / Minutes</div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 1.5rem; padding: 1rem; background: rgba(27, 121, 72, 0.1); border-radius: 8px;">
                        <strong style="color: var(--mfu-green);">คำแนะนำ / Recommendations:</strong>
                        <ul style="margin: 0.75rem 0 0 0; padding-left: 1.5rem; color: var(--text-primary);">
                            ${additionalDoctors > 0 ? `<li>เตรียมพร้อมเพิ่มแพทย์ ${additionalDoctors} ท่านเพื่อรองรับผู้ป่วยที่เพิ่มขึ้น</li>` : ''}
                            <li>จัดเตรียมเวชภัณฑ์และอุปกรณ์การแพทย์เพิ่มเติมประมาณ ${Math.round(((aiPrediction - currentMonthPatients) / currentMonthPatients) * 100)}%</li>
                            <li>วางแผนตารางเวรแพทย์และพยาบาลให้รองรับช่วงเวลาเร่งด่วน</li>
                            <li>เตรียมการตรวจสอบและปรับปรุงระบบ IT สำหรับการรองรับผู้ป่วยที่เพิ่มขึ้น</li>
                        </ul>
                    </div>
                </div>

                <!-- AI Patient Redistribution System -->
                <div class="card" style="background: linear-gradient(135deg, #fef3c7 0%, #fef9c3 100%); border-left: 4px solid var(--gold-nav); margin-top: 2rem;">
                    <h3 style="color: var(--gold-nav); margin-bottom: 1rem;">AI Smart Room Load Balancing</h3>
                    <p style="color: var(--text-secondary); margin-bottom: 1.5rem;">ระบบ AI วิเคราะห์และแนะนำการกระจายผู้ป่วยอัตโนมัติเพื่อลดเวลารอและเพิ่มประสิทธิภาพ / AI automatically analyzes and recommends patient redistribution to reduce wait time and improve efficiency</p>
                    
                    <!-- Current Room Load Status -->
                    <div style="background: white; padding: 1.5rem; border-radius: 8px; margin-bottom: 1.5rem;">
                        <h4 style="color: var(--text-primary); margin: 0 0 1rem 0;">สถานะห้องตรวจปัจจุบัน / Current Room Status</h4>
                        
                        <div style="display: grid; gap: 1rem;">
                            <!-- Overloaded Room -->
                            <div style="padding: 1rem; background: #fee2e2; border-radius: 8px; border: 2px solid #ef4444;">
                                <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem;">
                                    <div style="flex: 1; min-width: 200px;">
                                        <div style="font-weight: 700; color: #991b1b; font-size: 1.1rem;">ห้อง 101 / Room 101</div>
                                        <div style="color: #7f1d1d; margin-top: 0.25rem;">นพ. สมชาย ใจดี - OPD</div>
                                        <div style="color: #991b1b; margin-top: 0.5rem; font-size: 0.9rem;">สถานะ: โหลดสูง / Status: Overloaded</div>
                                    </div>
                                    <div style="text-align: center;">
                                        <div style="font-size: 2rem; font-weight: 700; color: #dc2626;">18</div>
                                        <div style="font-size: 0.9rem; color: #7f1d1d;">ผู้ป่วยในคิว / Patients</div>
                                    </div>
                                    <div style="text-align: center;">
                                        <div style="font-size: 1.5rem; font-weight: 700; color: #ea580c;">35</div>
                                        <div style="font-size: 0.9rem; color: #7c2d12;">นาที / min wait</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Normal Load Room -->
                            <div style="padding: 1rem; background: #fef3c7; border-radius: 8px; border: 2px solid var(--gold-nav);">
                                <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem;">
                                    <div style="flex: 1; min-width: 200px;">
                                        <div style="font-weight: 700; color: #92400e; font-size: 1.1rem;">ห้อง 102 / Room 102</div>
                                        <div style="color: #78350f; margin-top: 0.25rem;">พญ. สุดา รักษ์ดี - OPD</div>
                                        <div style="color: #92400e; margin-top: 0.5rem; font-size: 0.9rem;">สถานะ: ปกติ / Status: Normal</div>
                                    </div>
                                    <div style="text-align: center;">
                                        <div style="font-size: 2rem; font-weight: 700; color: var(--gold-nav);">8</div>
                                        <div style="font-size: 0.9rem; color: #78350f;">ผู้ป่วยในคิว / Patients</div>
                                    </div>
                                    <div style="text-align: center;">
                                        <div style="font-size: 1.5rem; font-weight: 700; color: var(--gold-nav);">16</div>
                                        <div style="font-size: 0.9rem; color: #78350f;">นาที / min wait</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Low Load Room -->
                            <div style="padding: 1rem; background: #d1fae5; border-radius: 8px; border: 2px solid var(--mfu-green);">
                                <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem;">
                                    <div style="flex: 1; min-width: 200px;">
                                        <div style="font-weight: 700; color: #065f46; font-size: 1.1rem;">ห้อง 103 / Room 103</div>
                                        <div style="color: #047857; margin-top: 0.25rem;">นพ. วิชัย สุขสันต์ - OPD</div>
                                        <div style="color: #065f46; margin-top: 0.5rem; font-size: 0.9rem;">สถานะ: พร้อมรับผู้ป่วย / Status: Available</div>
                                    </div>
                                    <div style="text-align: center;">
                                        <div style="font-size: 2rem; font-weight: 700; color: var(--mfu-green);">3</div>
                                        <div style="font-size: 0.9rem; color: #047857;">ผู้ป่วยในคิว / Patients</div>
                                    </div>
                                    <div style="text-align: center;">
                                        <div style="font-size: 1.5rem; font-weight: 700; color: var(--mfu-green);">8</div>
                                        <div style="font-size: 0.9rem; color: #047857;">นาที / min wait</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- AI Recommendations -->
                    <div style="background: white; padding: 1.5rem; border-radius: 8px; margin-bottom: 1.5rem;">
                        <h4 style="color: var(--text-primary); margin: 0 0 1rem 0;">คำแนะนำจาก AI / AI Recommendations</h4>
                        
                        <div style="background: #eff6ff; padding: 1.25rem; border-radius: 8px; border-left: 4px solid #3B82F6; margin-bottom: 1rem;">
                            <div style="display: flex; align-items: start; gap: 1rem;">
                                <div style="flex-shrink: 0; width: 32px; height: 32px; background: #3B82F6; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700;">AI</div>
                                <div style="flex: 1;">
                                    <strong style="color: #1e40af;">แนะนำการกระจายผู้ป่วย / Recommended Redistribution:</strong>
                                    <div style="margin-top: 0.75rem; color: var(--text-primary);">
                                        <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                                            <span style="color: #dc2626; font-weight: 600;">ห้อง 101</span>
                                            <span style="color: var(--text-secondary);">โอนผู้ป่วย 5 คน</span>
                                            <span style="color: #3B82F6;">→</span>
                                            <span style="color: var(--mfu-green); font-weight: 600;">ห้อง 103</span>
                                        </div>
                                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                                            <span style="color: #dc2626; font-weight: 600;">ห้อง 101</span>
                                            <span style="color: var(--text-secondary);">โอนผู้ป่วย 3 คน</span>
                                            <span style="color: #3B82F6;">→</span>
                                            <span style="color: var(--gold-nav); font-weight: 600;">ห้อง 102</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Expected Results -->
                        <div style="background: #f0fdf4; padding: 1.25rem; border-radius: 8px; border-left: 4px solid var(--mfu-green);">
                            <strong style="color: #065f46;">ผลลัพธ์ที่คาดว่าจะได้รับ / Expected Results:</strong>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-top: 1rem;">
                                <div style="text-align: center; padding: 1rem; background: white; border-radius: 6px;">
                                    <div style="font-size: 1.75rem; font-weight: 700; color: var(--mfu-green);">-43%</div>
                                    <div style="font-size: 0.9rem; color: var(--text-secondary); margin-top: 0.25rem;">ลดเวลารอ ห้อง 101<br>Wait time reduction</div>
                                </div>
                                <div style="text-align: center; padding: 1rem; background: white; border-radius: 6px;">
                                    <div style="font-size: 1.75rem; font-weight: 700; color: #3B82F6;">12 min</div>
                                    <div style="font-size: 0.9rem; color: var(--text-secondary); margin-top: 0.25rem;">เวลารอเฉลี่ยใหม่<br>New avg wait</div>
                                </div>
                                <div style="text-align: center; padding: 1rem; background: white; border-radius: 6px;">
                                    <div style="font-size: 1.75rem; font-weight: 700; color: var(--gold-nav);">+28%</div>
                                    <div style="font-size: 0.9rem; color: var(--text-secondary); margin-top: 0.25rem;">เพิ่มประสิทธิภาพ<br>Efficiency boost</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Action Button -->
                    <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                        <button class="btn btn-primary" onclick="applyAIRedistribution()" style="background: var(--mfu-green); border-color: var(--mfu-green); padding: 0.75rem 1.5rem;">
                            ใช้คำแนะนำของ AI / Apply AI Recommendation
                        </button>
                        <button class="btn btn-secondary" onclick="viewDetailedAnalysis()" style="padding: 0.75rem 1.5rem;">
                            ดูการวิเคราะห์โดยละเอียด / View Detailed Analysis
                        </button>
                    </div>

                    <div style="margin-top: 1rem; padding: 1rem; background: rgba(59, 130, 246, 0.1); border-radius: 6px;">
                        <div style="color: #1e40af; font-size: 0.9rem;">
                            <strong>หมายเหตุ:</strong> ระบบ AI วิเคราะห์จากปัจจัยหลายอย่าง เช่น จำนวนผู้ป่วย, ประเภทการรักษา, ความเชี่ยวชาญของแพทย์, และเวลาการรักษาเฉลี่ย<br>
                            <em>Note: AI analyzes multiple factors including patient count, treatment type, doctor expertise, and average treatment time</em>
                        </div>
                    </div>
                </div>
                
                <style>
                    @keyframes slideIn {
                        from { width: 0; }
                        to { width: ${(aiPrediction / 4000) * 100}%; }
                    }
                </style>
            `;
            
            // Scroll to top
            window.scrollTo(0, 0);
            
            console.log('AI Analytics Dashboard loaded with prediction:', aiPrediction);
        }

        // Apply AI Redistribution
        function applyAIRedistribution() {
            if (confirm('ยืนยันการกระจายผู้ป่วยตามคำแนะนำของ AI?\n\nConfirm patient redistribution based on AI recommendation?\n\n- ห้อง 101 → ห้อง 103: 5 คน\n- ห้อง 101 → ห้อง 102: 3 คน')) {
                alert('กำลังดำเนินการกระจายผู้ป่วย...\n\nRedistributing patients...\n\n✓ โอนผู้ป่วย 5 คนไปห้อง 103\n✓ โอนผู้ป่วย 3 คนไปห้อง 102\n✓ อัพเดทเวลารอคอย\n✓ แจ้งเตือนผู้ป่วยทราบการเปลี่ยนแปลง\n\nเสร็จสมบูรณ์! / Completed!\n\nเวลารอห้อง 101 ลดลงจาก 35 นาที → 20 นาที (-43%)');
                showAnalytics(); // Refresh the view
            }
        }

        // View Detailed Analysis
        function viewDetailedAnalysis() {
            alert('การวิเคราะห์โดยละเอียด / Detailed Analysis\n\n' +
                  'ปัจจัยที่ AI พิจารณา / AI Factors:\n\n' +
                  '1. จำนวนผู้ป่วยในคิวแต่ละห้อง\n' +
                  '2. ประเภทและความซับซ้อนของการรักษา\n' +
                  '3. ความเชี่ยวชาญเฉพาะทางของแพทย์\n' +
                  '4. เวลาการรักษาเฉลี่ยในอดีต\n' +
                  '5. ความพึงพอใจของผู้ป่วย\n' +
                  '6. ระยะเวลาที่ผู้ป่วยรอคอยแล้ว\n\n' +
                  'ความแม่นยำ: 94.2%\n' +
                  'ข้อมูลที่ใช้: Real-time + Historical');
        }

        function showCreateUser() {
            // Update active state in sidebar
            document.getElementById('overviewLink').classList.remove('active');
            document.getElementById('analyticsLink').classList.remove('active');
            document.getElementById('createUserLink').classList.add('active');
            const modal = document.createElement('div');
            modal.innerHTML = `
                <div style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 9999; display: flex; align-items: center; justify-content: center;" onclick="this.remove()">
                    <div style="background: white; border-radius: 12px; padding: 2.5rem; max-width: 600px; width: 90%; max-height: 90vh; overflow-y: auto;" onclick="event.stopPropagation()">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                            <h2 style="color: var(--mfu-green); margin: 0;">สร้างผู้ใช้ใหม่ / Create New User</h2>
                            <button onclick="this.closest('div[style*=fixed]').remove()" style="background: none; border: none; font-size: 2rem; cursor: pointer; color: var(--text-secondary);">×</button>
                        </div>
                        
                        <form id="createUserForm" style="display: flex; flex-direction: column; gap: 1.5rem;">
                            <div>
                                <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: var(--text-primary);">ประเภทผู้ใช้ / User Type *</label>
                                <select id="userType" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-gray); border-radius: 8px; font-size: 1rem;">
                                    <option value="">-- เลือก / Select --</option>
                                    <option value="patient">ผู้ป่วย / Patient</option>
                                    <option value="doctor">แพทย์/พยาบาล / Doctor/Nurse</option>
                                    <option value="admin">ผู้บริหาร / Administrator</option>
                                </select>
                            </div>

                            <div>
                                <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: var(--text-primary);">ชื่อ-นามสกุล / Full Name *</label>
                                <input type="text" id="fullName" required placeholder="นาย สมชาย ใจดี / Mr. Somchai Jaidee" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-gray); border-radius: 8px; font-size: 1rem;">
                            </div>

                            <div>
                                <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: var(--text-primary);">เลขประจำตัว / ID Number *</label>
                                <input type="text" id="userId" required placeholder="1234567890123 / E12345 / A001" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-gray); border-radius: 8px; font-size: 1rem;">
                                <small style="color: var(--text-secondary); display: block; margin-top: 0.5rem;">
                                    Patient: บัตรประชาชน 13 หลัก หรือ Passport | Doctor: E+หมายเลข | Admin: A+หมายเลข
                                </small>
                            </div>

                            <div>
                                <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: var(--text-primary);">รหัสผ่าน / Password *</label>
                                <input type="password" id="password" required placeholder="ขั้นต่ำ 6 ตัวอักษร / Min 6 characters" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-gray); border-radius: 8px; font-size: 1rem;">
                            </div>

                            <div>
                                <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: var(--text-primary);">อีเมล / Email</label>
                                <input type="email" id="email" placeholder="user@example.com" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-gray); border-radius: 8px; font-size: 1rem;">
                            </div>

                            <div>
                                <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: var(--text-primary);">เบอร์โทรศัพท์ / Phone Number</label>
                                <input type="tel" id="phone" placeholder="08X-XXX-XXXX" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-gray); border-radius: 8px; font-size: 1rem;">
                            </div>

                            <div style="display: flex; gap: 1rem; margin-top: 1rem;">
                                <button type="submit" class="btn btn-primary" style="flex: 1; padding: 1rem; font-size: 1.125rem;">
                                    สร้างผู้ใช้ / Create User
                                </button>
                                <button type="button" onclick="this.closest('div[style*=fixed]').remove()" class="btn btn-secondary" style="flex: 1; padding: 1rem; font-size: 1.125rem;">
                                    ยกเลิก / Cancel
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);

            // Handle form submission
            document.getElementById('createUserForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const userType = document.getElementById('userType').value;
                const fullName = document.getElementById('fullName').value;
                const userId = document.getElementById('userId').value;
                const password = document.getElementById('password').value;
                const email = document.getElementById('email').value;
                const phone = document.getElementById('phone').value;

                // Validate password length
                if (password.length < 6) {
                    alert('รหัสผ่านต้องมีอย่างน้อย 6 ตัวอักษร / Password must be at least 6 characters');
                    return;
                }

                // Show success message
                alert(`สร้างผู้ใช้สำเร็จ / User Created Successfully!\n\nประเภท / Type: ${userType}\nชื่อ / Name: ${fullName}\nรหัส / ID: ${userId}\nอีเมล / Email: ${email || 'ไม่ระบุ'}\nเบอร์โทร / Phone: ${phone || 'ไม่ระบุ'}\n\nผู้ใช้สามารถเข้าสู่ระบบได้ทันที / User can login immediately`);
                
                modal.remove();
            });
        }
    </script>
</body>
</html>
